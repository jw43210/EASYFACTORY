CREATE TABLE FEB_INDEX (
    Process_Feb            VARCHAR2(4),
    Month                  NUMBER(2),                         
    Difficulty             NUMBER(3),   
    Realtime_Difficulty    NUMBER(3),
    Elec_using             NUMBER(4),
    Production             NUMBER(6),
    InDex_Cost             NUMBER(5)
);

INSERT INTO FEB_INDEX VALUES('feb1', 1, 20, 20, 40, 90, 200);
INSERT INTO FEB_INDEX VALUES('feb1', 2, 20, 20, 40, 90, 200);
INSERT INTO FEB_INDEX VALUES('feb1', 3, 20, 20, 40, 90, 200);
INSERT INTO FEB_INDEX VALUES('feb1', 4, 20, 20, 40, 90, 200);
INSERT INTO FEB_INDEX VALUES('feb1', 5, 20, 20, 40, 90, 200);
INSERT INTO FEB_INDEX VALUES('feb1', 6, 20, 20, 40, 90, 200);
INSERT INTO FEB_INDEX VALUES('feb1', 7, 20, 20, 40, 90, 200);
INSERT INTO FEB_INDEX VALUES('feb1', 8, 20, 20, 40, 90, 200);
INSERT INTO FEB_INDEX VALUES('feb1', 9, 20, 20, 40, 90, 200);
INSERT INTO FEB_INDEX VALUES('feb1', 10, 20, 20, 40, 90, 200);
INSERT INTO FEB_INDEX VALUES('feb1', 11, 20, 20, 40, 90, 200);
INSERT INTO FEB_INDEX VALUES('feb1', 12, 20, 20, 40, 90, 200);

INSERT INTO FEB_INDEX VALUES('feb2', 1, 30, 30, 50, 90, 300);
INSERT INTO FEB_INDEX VALUES('feb2', 2, 30, 30, 50, 90, 300);
INSERT INTO FEB_INDEX VALUES('feb2', 3, 30, 30, 50, 90, 300);
INSERT INTO FEB_INDEX VALUES('feb2', 4, 30, 30, 50, 90, 300);
INSERT INTO FEB_INDEX VALUES('feb2', 5, 30, 30, 50, 90, 300);
INSERT INTO FEB_INDEX VALUES('feb2', 6, 30, 30, 50, 90, 300);
INSERT INTO FEB_INDEX VALUES('feb2', 7, 30, 30, 50, 90, 300);
INSERT INTO FEB_INDEX VALUES('feb2', 8, 30, 30, 50, 90, 300);
INSERT INTO FEB_INDEX VALUES('feb2', 9, 30, 30, 50, 90, 300);
INSERT INTO FEB_INDEX VALUES('feb2', 10, 30, 30, 50, 90, 300);
INSERT INTO FEB_INDEX VALUES('feb2', 11, 30, 30, 50, 90, 300);
INSERT INTO FEB_INDEX VALUES('feb2', 12, 30, 30, 50, 90, 300);

INSERT INTO FEB_INDEX VALUES('feb3', 1, 40, 40, 80, 80, 400);
INSERT INTO FEB_INDEX VALUES('feb3', 2, 40, 40, 80, 80, 400);
INSERT INTO FEB_INDEX VALUES('feb3', 3, 40, 40, 80, 80, 400);
INSERT INTO FEB_INDEX VALUES('feb3', 4, 40, 40, 80, 80, 400);
INSERT INTO FEB_INDEX VALUES('feb3', 5, 40, 40, 80, 80, 400);
INSERT INTO FEB_INDEX VALUES('feb3', 6, 40, 40, 80, 80, 400);
INSERT INTO FEB_INDEX VALUES('feb3', 7, 40, 40, 80, 80, 400);
INSERT INTO FEB_INDEX VALUES('feb3', 8, 40, 40, 80, 80, 400);
INSERT INTO FEB_INDEX VALUES('feb3', 9, 40, 40, 80, 80, 400);
INSERT INTO FEB_INDEX VALUES('feb3', 10, 40, 40, 80, 80, 400);
INSERT INTO FEB_INDEX VALUES('feb3', 11, 40, 40, 80, 80, 400);
INSERT INTO FEB_INDEX VALUES('feb3', 12, 40, 40, 80, 80, 400);

INSERT INTO FEB_INDEX VALUES('feb4', 1, 70, 70, 80, 80, 700);
INSERT INTO FEB_INDEX VALUES('feb4', 2, 70, 70, 80, 80, 700);
INSERT INTO FEB_INDEX VALUES('feb4', 3, 70, 70, 80, 80, 700);
INSERT INTO FEB_INDEX VALUES('feb4', 4, 70, 70, 80, 80, 700);
INSERT INTO FEB_INDEX VALUES('feb4', 5, 70, 70, 80, 80, 700);
INSERT INTO FEB_INDEX VALUES('feb4', 6, 70, 70, 80, 80, 700);
INSERT INTO FEB_INDEX VALUES('feb4', 7, 70, 70, 80, 80, 700);
INSERT INTO FEB_INDEX VALUES('feb4', 8, 70, 70, 80, 80, 700);
INSERT INTO FEB_INDEX VALUES('feb4', 9, 70, 70, 80, 80, 700);
INSERT INTO FEB_INDEX VALUES('feb4', 10, 70, 70, 80, 80, 700);
INSERT INTO FEB_INDEX VALUES('feb4', 11, 70, 70, 80, 80, 700);
INSERT INTO FEB_INDEX VALUES('feb4', 12, 70, 70, 80, 80, 700);

INSERT INTO FEB_INDEX VALUES('feb5', 1, 60, 60, 80, 80, 600);
INSERT INTO FEB_INDEX VALUES('feb5', 2, 60, 60, 80, 80, 600);
INSERT INTO FEB_INDEX VALUES('feb5', 3, 60, 60, 80, 80, 600);
INSERT INTO FEB_INDEX VALUES('feb5', 4, 60, 60, 80, 80, 600);
INSERT INTO FEB_INDEX VALUES('feb5', 5, 60, 60, 80, 80, 600);
INSERT INTO FEB_INDEX VALUES('feb5', 6, 60, 60, 80, 80, 600);
INSERT INTO FEB_INDEX VALUES('feb5', 7, 60, 60, 80, 80, 600);
INSERT INTO FEB_INDEX VALUES('feb5', 8, 60, 60, 80, 80, 600);
INSERT INTO FEB_INDEX VALUES('feb5', 9, 60, 60, 80, 80, 600);
INSERT INTO FEB_INDEX VALUES('feb5', 10, 60, 60, 80, 80, 600);
INSERT INTO FEB_INDEX VALUES('feb5', 11, 60, 60, 80, 80, 600);
INSERT INTO FEB_INDEX VALUES('feb5', 12, 60, 60, 80, 80, 600);

INSERT INTO FEB_INDEX VALUES('feb6', 1, 100, 100, 60, 70, 1000);
INSERT INTO FEB_INDEX VALUES('feb6', 2, 100, 100, 60, 70, 1000);
INSERT INTO FEB_INDEX VALUES('feb6', 3, 100, 100, 60, 70, 1000);
INSERT INTO FEB_INDEX VALUES('feb6', 4, 100, 100, 60, 70, 1000);
INSERT INTO FEB_INDEX VALUES('feb6', 5, 100, 100, 60, 70, 1000);
INSERT INTO FEB_INDEX VALUES('feb6', 6, 100, 100, 60, 70, 1000);
INSERT INTO FEB_INDEX VALUES('feb6', 7, 100, 100, 60, 70, 1000);
INSERT INTO FEB_INDEX VALUES('feb6', 8, 100, 100, 60, 70, 1000);
INSERT INTO FEB_INDEX VALUES('feb6', 9, 100, 100, 60, 70, 1000);
INSERT INTO FEB_INDEX VALUES('feb6', 10, 100, 100, 60, 70, 1000);
INSERT INTO FEB_INDEX VALUES('feb6', 11, 100, 100, 60, 70, 1000);
INSERT INTO FEB_INDEX VALUES('feb6', 12, 100, 100, 60, 70, 1000);

INSERT INTO FEB_INDEX VALUES('feb7', 1, 80, 80, 50, 80, 800);
INSERT INTO FEB_INDEX VALUES('feb7', 2, 80, 80, 50, 80, 800);
INSERT INTO FEB_INDEX VALUES('feb7', 3, 80, 80, 50, 80, 800);
INSERT INTO FEB_INDEX VALUES('feb7', 4, 80, 80, 50, 80, 800);
INSERT INTO FEB_INDEX VALUES('feb7', 5, 80, 80, 50, 80, 800);
INSERT INTO FEB_INDEX VALUES('feb7', 6, 80, 80, 50, 80, 800);
INSERT INTO FEB_INDEX VALUES('feb7', 7, 80, 80, 50, 80, 800);
INSERT INTO FEB_INDEX VALUES('feb7', 8, 80, 80, 50, 80, 800);
INSERT INTO FEB_INDEX VALUES('feb7', 9, 80, 80, 50, 80, 800);
INSERT INTO FEB_INDEX VALUES('feb7', 10, 80, 80, 50, 80, 800);
INSERT INTO FEB_INDEX VALUES('feb7', 11, 80, 80, 50, 80, 800);
INSERT INTO FEB_INDEX VALUES('feb7', 12, 80, 80, 50, 80, 800);

INSERT INTO FEB_INDEX VALUES('feb8', 1, 50, 50, 70, 90, 500);
INSERT INTO FEB_INDEX VALUES('feb8', 2, 50, 50, 70, 90, 500);
INSERT INTO FEB_INDEX VALUES('feb8', 3, 50, 50, 70, 90, 500);
INSERT INTO FEB_INDEX VALUES('feb8', 4, 50, 50, 70, 90, 500);
INSERT INTO FEB_INDEX VALUES('feb8', 5, 50, 50, 70, 90, 500);
INSERT INTO FEB_INDEX VALUES('feb8', 6, 50, 50, 70, 90, 500);
INSERT INTO FEB_INDEX VALUES('feb8', 7, 50, 50, 70, 90, 500);
INSERT INTO FEB_INDEX VALUES('feb8', 8, 50, 50, 70, 90, 500);
INSERT INTO FEB_INDEX VALUES('feb8', 9, 50, 50, 70, 90, 500);
INSERT INTO FEB_INDEX VALUES('feb8', 10, 50, 50, 70, 90, 500);
INSERT INTO FEB_INDEX VALUES('feb8', 11, 50, 50, 70, 90, 500);
INSERT INTO FEB_INDEX VALUES('feb8', 12, 50, 50, 70, 90, 500);

select * from feb_index;
COMMIT;
DROP TABLE FEB_INDEX;

select * from feb1 order by hiredate;

drop view feb_index_view_Difficulty;

CREATE VIEW feb_index_view_elec as
SELECT PROCESS_FEB, avg(elec_using) as elec_using 
    FROM feb_index
    GROUP BY process_feb
    ORDER BY process_feb;

-- 공정별 전기세 기준치 --    
CREATE VIEW feb_index_view_cost as
SELECT PROCESS_FEB, avg(InDex_Cost) as InDex_Cost 
    FROM feb_index
    GROUP BY process_feb
    ORDER BY process_feb;

-- 공정별 생산량 기준치 --
CREATE VIEW feb_index_view_production as
SELECT PROCESS_FEB, avg(production) as production 
    FROM feb_index
    GROUP BY process_feb
    ORDER BY process_feb;

-- 공정별 난이도 기준치 --    
CREATE VIEW feb_index_view_Difficulty as
SELECT PROCESS_FEB, avg(Difficulty) as Difficulty 
    FROM feb_index
    GROUP BY process_feb
    ORDER BY process_feb;    

SELECT * FROM feb_index_view_elec;
SELECT * FROM feb_index_view_cost;

SELECT * FROM feb_index_view_production;
SELECT * FROM feb_index_view_Difficulty;

SELECT elec_using AS elecData, InDex_Cost AS costData FROM feb_index_view_elec, feb_index_view_cost;

SELECT 
    a.process_feb,
    a.elec_using,
    b.InDex_Cost
FROM feb_index_view_elec a
INNER JOIN (
    SELECT
        b.process_feb,
        b.InDex_Cost
    FROM feb_index_view_cost b
) b ON a.process_feb = b.process_feb;

